/* src/styles/CoreBoxInventory.css */
/* =========================================================
   CoreBoxInventory â€” Compact XS UI (App.css tokens only)
   - Single inner scroller (.cbi-table-wrap)
   - Sticky header, drawer-safe layout
   - Minimal heights/spacing for dense data
   ========================================================= */

/* ---------- Container / page ---------- */
.cbi-wrap{
  --fs-xs: var(--font-size-xxs);
  display:flex;
  flex-direction:column;
  height:100%;
  min-height:0;
  width:100%;
  margin:0 auto;
  color:var(--text-primary);
  font-size: var(--fs-xs);
  line-height:1.3;
  position:relative;
  z-index:1;
  overflow-x: clip;
}

/* When drawer opens, keep table visible without pushing layout wider */
.cbi-wrap.cbi-drawer-open .cbi-table-wrap{
  padding-right: min(360px, calc(100vw - var(--sidebar-w, 0px)));
}

/* ---------- Top bar ---------- */
.cbi-topbar{
  display:flex; align-items:center; justify-content:space-between;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius);
  background: var(--bg-card);
  box-shadow: var(--shadow-md);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  position:relative;
}
.cbi-topbar::before{
  content:"";
  position:absolute; inset:0 0 auto 0; height:1px;
  background: linear-gradient(90deg, transparent, var(--color-primary), var(--color-secondary), var(--color-primary), transparent);
  opacity:.45;
}
.cbi-filters,.cbi-meta{
  display:flex; align-items:center; gap: var(--space-2); flex-wrap:wrap;
}
.cbi-count{ color:var(--text-muted); }

/* ---------- Controls ---------- */
.cbi-input,
.cbi-select{
  background: var(--bg-card-2);
  border:1px solid var(--border-color);
  color: var(--text-primary);
  border-radius: var(--radius);
  height:22px;
  padding:0 var(--space-2);
  font-size: var(--fs-xs);
  outline:none;
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast), transform var(--transition-fast);
}
.cbi-input::placeholder{ color: var(--text-muted); }
.cbi-input:hover,
.cbi-select:hover{ border-color: var(--color-primary); }
.cbi-input:focus,
.cbi-select:focus{
  border-color: var(--color-primary);
  box-shadow: 0 0 0 2px color-mix(in oklab, var(--color-primary) 24%, transparent);
  background: var(--bg-card);
  transform: translateY(-1px);
}

.cbi-checkbox{
  display:flex; align-items:center; gap: var(--space-2);
  color: var(--text-secondary);
  user-select:none;
  font-size: var(--fs-xs);
}

.cbi-input-inline,
.cbi-select-inline{
  height:20px;
  font-size: var(--fs-xs);
  padding:0 var(--space-2);
  width:100%;
  min-width:0;
  box-sizing:border-box;
}
.cbi-input-inline[type="date"]{ min-width:120px; }

/* ---------- Buttons ---------- */
.cbi-btn{
  background: var(--bg-card-2);
  color: var(--text-primary);
  border:1px solid var(--border-color);
  border-radius: var(--radius);
  height:22px;
  padding:0 var(--space-2);
  font-size: var(--fs-xs);
  cursor:pointer;
  transition: transform var(--transition-fast), border-color var(--transition-fast), background var(--transition-fast), box-shadow var(--transition-fast), filter var(--transition-fast);
  position:relative;
  overflow:hidden;
}
.cbi-btn::after{
  content:"";
  position:absolute; inset:0;
  background: radial-gradient(120% 60% at 10% 10%, color-mix(in oklab, var(--color-primary) 18%, transparent), transparent 40%);
  opacity:0; transition: opacity var(--transition-fast);
}
.cbi-btn:hover::after{ opacity:1; }
.cbi-btn:hover{
  transform: translateY(-1px);
  border-color: var(--color-primary);
  background: var(--bg-hover);
  box-shadow: var(--shadow-md);
}
.cbi-btn--ghost{ background: transparent; }
.cbi-btn--danger{
  border-color: color-mix(in oklab, var(--color-warning) 35%, var(--border-color));
  color: color-mix(in oklab, var(--color-warning) 70%, var(--text-primary));
}

/* Tiny icon buttons in table rows */
.cbi-actions{ white-space:nowrap; display:flex; align-items:center; gap: var(--space-2); }
.cbi-iconbtn{
  background: var(--bg-card);
  border:1px solid var(--border-color);
  color: var(--text-primary);
  padding:0 var(--space-2);
  height:20px;
  border-radius: calc(var(--radius) - 2px);
  cursor:pointer;
  display:inline-flex; align-items:center; justify-content:center;
  font-size: var(--fs-xs);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast), transform .05s ease, background var(--transition-fast);
}
.cbi-iconbtn:hover{
  border-color: var(--color-primary);
  background: var(--bg-hover);
  box-shadow: 0 0 0 2px color-mix(in oklab, var(--color-primary) 18%, transparent);
}
.cbi-iconbtn:active{ transform: translateY(1px); }
.cbi-iconbtn--danger{ color: color-mix(in oklab, var(--color-warning) 70%, var(--text-primary)); border-color: color-mix(in oklab, var(--color-warning) 35%, var(--border-color)); }

/* ---------- New row inline ---------- */
.cbi-newrow{
  display:grid;
  grid-template-columns: repeat(10, minmax(110px,1fr)) auto auto;
  gap: var(--space-2);
  padding: var(--space-2);
  border:1px solid var(--border-color);
  border-radius: var(--radius);
  background: var(--bg-card);
  box-shadow: var(--shadow-md);
  margin-bottom: var(--space-3);
}

/* ---------- Inline error ---------- */
.cbi-inline-error{
  margin: var(--space-2) 0;
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius);
  border: 1px solid var(--border-color);
  color: var(--color-warning);
  background: color-mix(in oklab, var(--color-warning) 12%, transparent);
}

/* ---------- Table scroller ---------- */
.cbi-table-wrap{
  flex:1 1 auto;
  min-height:0;
  overflow-y: auto;
  overflow-x: hidden;
  border:1px solid var(--border-color);
  border-radius: var(--radius);
  background: var(--bg-card);
  box-shadow: var(--shadow-md);
  position:relative;
}

/* smooth scrollbars */
.cbi-table-wrap{
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,0.35) transparent;
}
.cbi-table-wrap::-webkit-scrollbar{ width:8px; height:8px; }
.cbi-table-wrap::-webkit-scrollbar-track{ background: transparent; }
.cbi-table-wrap::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,0.18);
  border-radius: 8px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
.cbi-table-wrap::-webkit-scrollbar-thumb:hover{ background: rgba(255,255,255,0.28); }

/* ---------- Table ---------- */
.cbi-table{
  width:100%;
  border-collapse:collapse;
  table-layout: fixed;
  font-size: var(--fs-xs);
  min-width: 880px;
}

.cbi-th{
  position:sticky; top:0; z-index:1;
  text-align:left; white-space:nowrap;
  padding: var(--space-2) var(--space-3);
  background: var(--bg-card-2);
  border-bottom:1px solid var(--border-color);
  color: var(--text-secondary);
  cursor:pointer;
  user-select:none;
}
.cbi-th:hover{ color: var(--text-primary); }

.cbi-table td{
  padding: var(--space-2) var(--space-3);
  vertical-align:middle;
  max-width: 420px;
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
  border-bottom:1px dashed color-mix(in oklab, var(--text-muted) 30%, transparent);
  color: var(--text-primary);
  background: transparent;
}
.cbi-mono{
  font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
}

/* Editing row highlight */
tr.cbi-editing td{
  overflow:visible; white-space:normal;
  background: color-mix(in oklab, var(--color-primary) 10%, transparent);
}

/* Status / expired */
.cbi-expired{ color: var(--color-warning); }

/* States */
.cbi-empty{
  text-align:center;
  padding: var(--space-3);
  color: var(--text-muted);
  font-size: var(--fs-xs);
}
.cbi-loading{
  text-align:center;
  padding: var(--space-3);
  color: var(--text-secondary);
  font-weight:700;
}

/* ---------- Pager ---------- */
.cbi-pager{
  display:flex; align-items:center; justify-content:center;
  gap: var(--space-2);
  padding: var(--space-2);
  font-size: var(--fs-xs);
}
.cbi-page{ color: var(--text-muted); }

/* ---------- Badges ---------- */
.cbi-badge{
  padding: 2px 8px;
  border-radius: 999px;
  font-size: var(--fs-xs);
  border:1px solid var(--border-color);
  box-shadow: 0 0 6px color-mix(in oklab, var(--color-primary) 12%, transparent) inset;
}
.cbi-badge--ok{
  background: color-mix(in oklab, var(--color-tertiary) 14%, transparent);
  color: var(--color-tertiary);
  border-color: color-mix(in oklab, var(--color-tertiary) 35%, var(--border-color));
}
.cbi-badge--danger{
  background: color-mix(in oklab, var(--color-warning) 18%, transparent);
  color: var(--color-warning);
  border-color: color-mix(in oklab, var(--color-warning) 35%, var(--border-color));
}
.cbi-badge--neutral{
  background: var(--bg-card-2);
  color: var(--text-secondary);
}

/* ---------- Modal ---------- */
.cbi-modal{
  position:fixed; inset:0;
  background: rgba(0,0,0,.45);
  display:grid; place-items:center;
  z-index:1000;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}
.cbi-modal-card{
  background: var(--bg-card);
  border:1px solid var(--border-color);
  border-radius: var(--radius);
  width: 460px; max-width: 95vw;
  padding: var(--space-3);
  box-shadow: var(--shadow-lg);
  font-size: var(--fs-xs);
}
.cbi-modal-title{ font-weight:800; margin-bottom: var(--space-2); color: var(--text-primary); }
.cbi-modal-body{ color: var(--text-secondary); }
.cbi-modal-note{ color: var(--text-muted); margin-top: var(--space-2); }
.cbi-modal-actions{
  display:flex; justify-content:flex-end; gap: var(--space-2);
  margin-top: var(--space-3);
}

/* ---------- Toast ---------- */
.cbi-toast{
  position:fixed; left:50%; transform:translateX(-50%);
  bottom: var(--space-5);
  background: var(--bg-card);
  border:1px solid var(--border-color);
  border-radius: var(--radius);
  padding: var(--space-2) var(--space-3);
  display:flex; gap: var(--space-2); align-items:center;
  font-size: var(--fs-xs);
  color: var(--text-secondary);
  z-index:999;
  box-shadow: var(--shadow-md);
}

/* ---------- History Drawer ---------- */
.cbi-backdrop{
  position:fixed; top:0; bottom:0; right:0; left: var(--sidebar-w, 0px);
  background: rgba(0,0,0,.35);
  z-index:890;
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}
.cbi-history{
  position:fixed; right:0; top:0; bottom:0;
  width: min(360px, calc(100vw - var(--sidebar-w, 0px)));
  background: var(--bg-card);
  border-left:1px solid var(--border-color);
  padding: var(--space-3);
  overflow:auto;
  z-index:900;
  box-shadow: -10px 0 30px rgba(0,0,0,.35);
  font-size: var(--fs-xs);
}
.cbi-history-head{
  position:sticky; top:0; z-index:1;
  display:flex; align-items:center; justify-content:space-between;
  padding-bottom: var(--space-2); margin-bottom: var(--space-2);
  background: linear-gradient(180deg, var(--bg-card) 70%, rgba(0,0,0,0));
  border-bottom:1px solid var(--border-color);
}
.cbi-history-title{ font-weight:800; color: var(--text-primary); }
.cbi-history-list{ display:grid; gap: var(--space-2); }
.cbi-history-item{
  border:1px solid var(--border-color);
  border-radius: var(--radius);
  padding: var(--space-2);
  background: var(--bg-card-2);
  display:flex; align-items:center; justify-content:space-between;
}
.cbi-history-meta{ display:flex; gap: var(--space-2); align-items:center; color: var(--text-secondary); }

/* ---------- Compact tweaks ---------- */
.cbi-th{ padding: var(--space-2) var(--space-3); }
.cbi-table td{ padding: var(--space-2) var(--space-3); line-height:1.2; }

/* ---------- Focus rings ---------- */
.cbi-btn:focus-visible,
.cbi-iconbtn:focus-visible,
.cbi-input:focus-visible,
.cbi-select:focus-visible{
  outline:2px solid var(--color-primary);
  outline-offset:2px;
}

/* ---------- Responsive ---------- */
@media (max-width: 900px){
  .cbi-wrap{ padding: var(--space-3) var(--space-2); max-width:100%; }
  .cbi-newrow{ grid-template-columns: repeat(4, 1fr); }
  .cbi-table{ min-width: 760px; }
}
@media (max-width: 640px){
  .cbi-table{ min-width: 680px; }
}
